var a=Object.defineProperty;var c=(n,t,e)=>t in n?a(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var s=(n,t,e)=>(c(n,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const r of d.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function e(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(o){if(o.ep)return;o.ep=!0;const d=e(o);fetch(o.href,d)}})();class m{constructor(){s(this,"todos");s(this,"onTodoListChanged");const t=localStorage.getItem("todos");if(t!==null){this.todos=JSON.parse(t);return}else this.todos=[]}bindTodoListChanged(t){this.onTodoListChanged=t}_commit(t){if(this.onTodoListChanged){this.onTodoListChanged(t),localStorage.setItem("todos",JSON.stringify(t));return}throw new Error("Bind onTodoListChanged to the View method that rerenders the dom")}addTodo(t){const e={id:this.todos.length>0?this.todos[this.todos.length-1].id+1:1,text:t,isComplete:!1};this.todos.push(e),this._commit(this.todos)}editTodo(t,e){this.todos=this.todos.map(i=>i.id===t?{id:i.id,text:e,isComplete:i.isComplete}:i),this._commit(this.todos)}deleteTodo(t){this.todos=this.todos.filter(e=>e.id!==t),this._commit(this.todos)}toggleTodo(t){this.todos=this.todos.map(e=>e.id===t?{id:e.id,text:e.text,isComplete:!e.isComplete}:e),this._commit(this.todos)}}class u{constructor(t){s(this,"app");s(this,"form");s(this,"input");s(this,"submitButton");s(this,"title");s(this,"todoList");s(this,"_temporaryTodoText");this.app=t,this.form=this.createElement("form"),this.input=this.createElement("input"),this.input.type="text",this.input.placeholder="Add todo",this.input.name="todo",this.submitButton=this.createElement("button"),this.submitButton.textContent="Submit",this.form.append(this.input,this.submitButton),this.title=this.createElement("h1"),this.title.textContent="Todos",this.todoList=this.createElement("ul","todo-list"),this.app.append(this.title,this.form,this.todoList),this._temporaryTodoText="",this._initLocalListeners()}get _todoText(){return this.input.value}_resetInput(){this.input.value=""}createElement(t,e){const i=document.createElement(t);return e&&i.classList.add(e),i}getElement(t){return document.querySelector(t)}displayTodos(t){for(;this.todoList.firstChild;)this.todoList.removeChild(this.todoList.firstChild);if(t.length===0){const e=this.createElement("p");e.textContent="Nothing to do! Add a task?",this.todoList.append(e)}else t.forEach(e=>{const i=this.createElement("li");i.id=e.id.toString();const o=this.createElement("input");o.type="checkbox",o.checked=e.isComplete;const d=this.createElement("span");if(d.contentEditable=(!0).toString(),d.classList.add("editable"),e.isComplete){const l=this.createElement("s");l.textContent=e.text,d.append(l)}else d.textContent=e.text;const r=this.createElement("button","delete");r.textContent="Delete",i.append(o,d,r),this.todoList.append(i)});console.log(t)}_initLocalListeners(){this.todoList.addEventListener("input",t=>{t.target.className.includes("editable")&&(this._temporaryTodoText=t.target.innerText)})}bindAddTodo(t){this.form.addEventListener("submit",e=>{e.preventDefault(),this._todoText&&(t(this._todoText),this._resetInput())})}bindDeleteTodo(t){this.todoList.addEventListener("click",e=>{if(e.target===null)return;const i=e.target;if(i.className.includes("delete")){const o=parseInt(i.parentElement.id);t(o)}})}bindEditTodo(t){this.todoList.addEventListener("focusout",e=>{if(e.target===null)return;const i=e.target;if(this._temporaryTodoText.trim()){const o=parseInt(i.parentElement.id);t(o,this._temporaryTodoText),this._temporaryTodoText=""}})}bindToggleTodo(t){this.todoList.addEventListener("change",e=>{if(e.target===null)return;const i=e.target;if(i.type==="checkbox"){const o=parseInt(i.parentElement.id);t(o)}})}}function h(n,...t){return new n(...t)}class p{constructor(t,e){s(this,"model");s(this,"view");s(this,"viewContructor");s(this,"onTodoListChanged",t=>{this.view.displayTodos(t)});s(this,"handleAddTodo",t=>{this.model.addTodo(t)});s(this,"handleEditTodo",(t,e)=>{this.model.editTodo(t,e)});s(this,"handleDeleteTodo",t=>{this.model.deleteTodo(t)});s(this,"handleToggleTodo",t=>{this.model.toggleTodo(t)});this.model=h(t),this.model.bindTodoListChanged(this.onTodoListChanged),this.viewContructor=e}mount(t){this.view=h(this.viewContructor,t),this.view.bindAddTodo(this.handleAddTodo),this.view.bindEditTodo(this.handleEditTodo),this.view.bindDeleteTodo(this.handleDeleteTodo),this.view.bindToggleTodo(this.handleToggleTodo),this.view.displayTodos(this.model.todos)}}(function(){const t=new p(m,u),e=document.getElementById("root");e!==null&&t.mount(e)})();
